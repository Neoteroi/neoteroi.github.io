
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The official documentation website of BlackSheep, a fast ASGI web framework for Python asyncio.">
      
      
        <meta name="author" content="Roberto Prevato">
      
      
        <link rel="canonical" href="https://www.neoteroi.dev/blacksheep/openapi/">
      
      
        <link rel="prev" href="/blacksheep/dependency-injection/">
      
      
        <link rel="next" href="/blacksheep/application/">
      
      <link rel="icon" href="/blacksheep/img/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>OpenAPI Docs - BlackSheep</title>
      
    
    
      <link rel="stylesheet" href="/blacksheep/assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="/blacksheep/assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="/blacksheep/css/neoteroi.css">
    
      <link rel="stylesheet" href="/blacksheep/css/extra.css?v=20221120">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-T65MX5XNF2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-T65MX5XNF2');
</script>

    
    
  
  
    
  
  
  <meta property="og:type" content="website">
  <meta property="og:title" content="BlackSheep - OpenAPI Docs">
  <meta property="og:description" content="The official documentation website of BlackSheep, a fast ASGI web framework for Python asyncio.">
  <meta property="og:url" content="https://www.neoteroi.dev/blacksheep/openapi/">
  <meta property="og:image" content="https://www.neoteroi.dev/blacksheep/img/banner.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="1080">
  <meta property="og:image:height" content="568">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@RobertoPrevato">
  <meta name="twitter:creator" content="@RobertoPrevato">
  <meta name="twitter:title" content="BlackSheep - OpenAPI Docs">
  <meta name="twitter:description" content="The official documentation website of BlackSheep, a fast ASGI web framework for Python asyncio.">
  <meta name="twitter:image" content="https://www.neoteroi.dev/blacksheep/img/banner.png">

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#openapi-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="/blacksheep/" title="BlackSheep" class="md-header__button md-logo" aria-label="BlackSheep" data-md-component="logo">
      
  <img src="/blacksheep/img/logow.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BlackSheep
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OpenAPI Docs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Neoteroi/BlackSheep" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Neoteroi/BlackSheep
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="/blacksheep/" title="BlackSheep" class="md-nav__button md-logo" aria-label="BlackSheep" data-md-component="logo">
      
  <img src="/blacksheep/img/logow.svg" alt="logo">

    </a>
    BlackSheep
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Neoteroi/BlackSheep" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Neoteroi/BlackSheep
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/getting-started/" class="md-nav__link">
        Getting started: basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/mvc-project-template/" class="md-nav__link">
        Getting started: MVC
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/dependency-injection/" class="md-nav__link">
        Dependency injection
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          OpenAPI Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        OpenAPI Docs
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-openapi-documentation" class="md-nav__link">
    Introduction to OpenAPI Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#built-in-support-for-openapi-documentation" class="md-nav__link">
    Built-in support for OpenAPI Documentation
  </a>
  
    <nav class="md-nav" aria-label="Built-in support for OpenAPI Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-description-and-summary" class="md-nav__link">
    Adding description and summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignoring-endpoints" class="md-nav__link">
    Ignoring endpoints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#document-only-certain-routes" class="md-nav__link">
    Document only certain routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documenting-response-examples" class="md-nav__link">
    Documenting response examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-code-pollution-using-endpointdocs" class="md-nav__link">
    Avoid code pollution using EndpointDocs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecating-an-api" class="md-nav__link">
    Deprecating an API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#altering-the-specification-upon-creation" class="md-nav__link">
    Altering the specification upon creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-common-responses" class="md-nav__link">
    Handling common responses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#support-for-generics" class="md-nav__link">
    Support for generics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#describing-parameters" class="md-nav__link">
    Describing parameters
  </a>
  
    <nav class="md-nav" aria-label="Describing parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documenting-parameters-explicitly" class="md-nav__link">
    Documenting parameters explicitly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documenting-parameters-using-docstrings" class="md-nav__link">
    Documenting parameters using docstrings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-access" class="md-nav__link">
    Anonymous access
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#support-for-redoc-ui" class="md-nav__link">
    Support for ReDoc UI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-implement-a-custom-uiprovider" class="md-nav__link">
    How to implement a custom UIProvider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-operations-ids" class="md-nav__link">
    Changing operations ids
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-more-details" class="md-nav__link">
    For more details
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/application/" class="md-nav__link">
        Application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/routing/" class="md-nav__link">
        Routing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/request-handlers/" class="md-nav__link">
        Request handlers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/requests/" class="md-nav__link">
        Requests
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/responses/" class="md-nav__link">
        Responses
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/templating/" class="md-nav__link">
        Templating
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/controllers/" class="md-nav__link">
        Controllers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/middlewares/" class="md-nav__link">
        Middlewares
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/static-files/" class="md-nav__link">
        Serving static files
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/websocket/" class="md-nav__link">
        WebSocket
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/server-sent-events/" class="md-nav__link">
        Server-sent events
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/authorization/" class="md-nav__link">
        Authorization
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/openid-connect/" class="md-nav__link">
        OpenID Connect
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/sessions/" class="md-nav__link">
        Sessions
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_22" >
      
      
      
        <label class="md-nav__link" for="__nav_22" id="__nav_22_label" tabindex="0">
          Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_22_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_22">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/cors/" class="md-nav__link">
        CORS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/anti-request-forgery/" class="md-nav__link">
        Anti-Forgery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/dataprotection/" class="md-nav__link">
        Data protection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/hsts/" class="md-nav__link">
        HSTS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/remotes/" class="md-nav__link">
        Remotes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_23" >
      
      
      
        <label class="md-nav__link" for="__nav_23" id="__nav_23_label" tabindex="0">
          Response features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_23_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_23">
          <span class="md-nav__icon md-icon"></span>
          Response features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/cache-control/" class="md-nav__link">
        Cache control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/compression/" class="md-nav__link">
        Compression
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_24" >
      
      
      
        <label class="md-nav__link" for="__nav_24" id="__nav_24_label" tabindex="0">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_24_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_24">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/examples/marshmallow/" class="md-nav__link">
        Using Marshmallow
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/settings/" class="md-nav__link">
        Settings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/binders/" class="md-nav__link">
        Binders
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/background-tasks/" class="md-nav__link">
        Background tasks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/mounting/" class="md-nav__link">
        Mounting apps
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/client/" class="md-nav__link">
        HTTP Client
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/cli/" class="md-nav__link">
        More about the CLI
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/versions/migrating-to-v2/" class="md-nav__link">
        From V1 to V2
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/develop-with-https/" class="md-nav__link">
        Develop using HTTPS
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/asgi/" class="md-nav__link">
        ASGI
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/extensions/" class="md-nav__link">
        Extensions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/blacksheep/about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/" class="md-nav__link">
        Neoteroi docs home
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-openapi-documentation" class="md-nav__link">
    Introduction to OpenAPI Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#built-in-support-for-openapi-documentation" class="md-nav__link">
    Built-in support for OpenAPI Documentation
  </a>
  
    <nav class="md-nav" aria-label="Built-in support for OpenAPI Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-description-and-summary" class="md-nav__link">
    Adding description and summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignoring-endpoints" class="md-nav__link">
    Ignoring endpoints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#document-only-certain-routes" class="md-nav__link">
    Document only certain routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documenting-response-examples" class="md-nav__link">
    Documenting response examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-code-pollution-using-endpointdocs" class="md-nav__link">
    Avoid code pollution using EndpointDocs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecating-an-api" class="md-nav__link">
    Deprecating an API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#altering-the-specification-upon-creation" class="md-nav__link">
    Altering the specification upon creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-common-responses" class="md-nav__link">
    Handling common responses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#support-for-generics" class="md-nav__link">
    Support for generics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#describing-parameters" class="md-nav__link">
    Describing parameters
  </a>
  
    <nav class="md-nav" aria-label="Describing parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documenting-parameters-explicitly" class="md-nav__link">
    Documenting parameters explicitly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documenting-parameters-using-docstrings" class="md-nav__link">
    Documenting parameters using docstrings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-access" class="md-nav__link">
    Anonymous access
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#support-for-redoc-ui" class="md-nav__link">
    Support for ReDoc UI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-implement-a-custom-uiprovider" class="md-nav__link">
    How to implement a custom UIProvider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-operations-ids" class="md-nav__link">
    Changing operations ids
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-more-details" class="md-nav__link">
    For more details
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

  
                  


<h1 id="openapi-documentation">OpenAPI Documentation<a class="headerlink" href="#openapi-documentation" title="Permanent link">&para;</a></h1>
<p>BlackSheep implements automatic generation of OpenAPI Documentation for most
common scenarios, and provides methods to enrich the documentation with
details. This page describes the following:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> An introduction to OpenAPI Documentation.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Built-in support for OpenAPI Documentation.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> How to document endpoints.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> How to handle common responses.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Expose the documentation for anonymous access.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Support for <a href="https://github.com/Redocly/redoc">ReDoc UI</a>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> How to implement a custom <code>UIProvider</code>.</li>
</ul>
<h2 id="introduction-to-openapi-documentation">Introduction to OpenAPI Documentation<a class="headerlink" href="#introduction-to-openapi-documentation" title="Permanent link">&para;</a></h2>
<p>Citing from the <a href="https://swagger.io/specification/">Swagger website</a>, at the
time of this writing:</p>
<blockquote>
<p>The OpenAPI Specification (OAS) defines a standard {...}
interface to RESTful APIs which allows both humans and computers to discover
and understand the capabilities of the service {...}.</p>
<p>An OpenAPI definition can then be used by documentation generation tools to
display the API, code generation tools to generate servers and clients in
various programming languages, testing tools, and many other use cases.</p>
</blockquote>
<p>Since a web application knows by definition the paths it is handling, and since
a certain amount of metadata can be inferred from the source code, BlackSheep
implements automatic generation of OpenAPI Documentation, and offers an API
to enrich the documentation with information that cannot be inferred from the
source code.</p>
<p>If you followed the <a href="/blacksheep/mvc-project-template">Getting started: MVC</a> tutorial,
its project template is configured to include an example of OpenAPI
Documentation and to expose a Swagger UI at <code>/docs</code> path.</p>
<p><img alt="OpenAPI Docs" src="/blacksheep/img/openapi-docs.png" /></p>
<h2 id="built-in-support-for-openapi-documentation">Built-in support for OpenAPI Documentation<a class="headerlink" href="#built-in-support-for-openapi-documentation" title="Permanent link">&para;</a></h2>
<p>The following piece of code describes a minimal set-up to enable generation of
OpenAPI Documentation and exposing a Swagger UI in BlackSheep:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="kn">from</span> <span class="nn">blacksheep</span> <span class="kn">import</span> <span class="n">Application</span><span class="p">,</span> <span class="n">get</span>
<span class="kn">from</span> <span class="nn">blacksheep.server.openapi.v3</span> <span class="kn">import</span> <span class="n">OpenAPIHandler</span>
<span class="kn">from</span> <span class="nn">openapidocs.v3</span> <span class="kn">import</span> <span class="n">Info</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

<span class="n">docs</span> <span class="o">=</span> <span class="n">OpenAPIHandler</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example API&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">))</span>
<span class="n">docs</span><span class="o">.</span><span class="n">bind_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="n">foo</span><span class="p">:</span> <span class="nb">str</span>


<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/foo&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Foo</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Foo</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span>
</code></pre></div>
<p>If you start this application and navigate to its <code>/docs</code> route, you will see
a Swagger UI like this:</p>
<p><img alt="Minimal OpenAPI Setup" src="/blacksheep/img/minimal-openapi-setup.png" /></p>
<hr />
<p>In this example, BlackSheep generates this specification file in JSON format,
at <code>/openapi.json</code> path:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;openapi&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3.0.3&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Example API&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.0.1&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;paths&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;/foo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;get&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;responses&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;200&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Success response&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nt">&quot;application/json&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/components/schemas/Foo&quot;</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;operationId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;get_foo&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;servers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">    </span><span class="nt">&quot;components&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;schemas&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Foo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="s2">&quot;foo&quot;</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">                </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;foo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;nullable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Note how the <code>Foo</code> component schema is automatically documented. <code>BlackSheep</code>
supports both <code>@dataclass</code> and <code>Pydantic</code> models for the automatic generation
of documentation.</p>
<p>And also YAML format at <code>/openapi.yaml</code> path:</p>
<div class="highlight"><pre><span></span><code><span class="nt">openapi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.0.3</span>
<span class="nt">info</span><span class="p">:</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Example API</span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.1</span>
<span class="nt">paths</span><span class="p">:</span>
<span class="w">    </span><span class="nt">/foo</span><span class="p">:</span>
<span class="w">        </span><span class="nt">get</span><span class="p">:</span>
<span class="w">            </span><span class="nt">responses</span><span class="p">:</span>
<span class="w">                </span><span class="s">&#39;200&#39;</span><span class="p p-Indicator">:</span>
<span class="w">                    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Success response</span>
<span class="w">                    </span><span class="nt">content</span><span class="p">:</span>
<span class="w">                        </span><span class="nt">application/json</span><span class="p">:</span>
<span class="w">                            </span><span class="nt">schema</span><span class="p">:</span>
<span class="w">                                </span><span class="nt">$ref</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;#/components/schemas/Foo&#39;</span>
<span class="w">            </span><span class="nt">operationId</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">get_foo</span>
<span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="nt">components</span><span class="p">:</span>
<span class="w">    </span><span class="nt">schemas</span><span class="p">:</span>
<span class="w">        </span><span class="nt">Foo</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">            </span><span class="nt">required</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo</span>
<span class="w">            </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">                </span><span class="nt">foo</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">                    </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
<p>To provide more details for api routes, decorate request handlers using the
instance of <code>OpenAPIHandler</code> as a decorator:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@docs</span><span class="p">(</span><span class="n">responses</span><span class="o">=</span><span class="p">{</span><span class="mi">200</span><span class="p">:</span> <span class="s2">&quot;Returns a text saying OpenAPI Example&quot;</span><span class="p">})</span>
<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;OpenAPI Example&quot;</span>
</code></pre></div>
<p>After this change, the specification file includes the new information:</p>
<div class="highlight"><pre><span></span><code><span class="nt">openapi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.0.3</span>
<span class="nt">info</span><span class="p">:</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Example API</span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.1</span>
<span class="nt">paths</span><span class="p">:</span>
<span class="w">    </span><span class="nt">/</span><span class="p">:</span>
<span class="w">        </span><span class="nt">get</span><span class="p">:</span>
<span class="w">            </span><span class="nt">responses</span><span class="p">:</span>
<span class="w">                </span><span class="s">&#39;200&#39;</span><span class="p p-Indicator">:</span>
<span class="w">                    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Returns a text saying OpenAPI Example</span>
<span class="w">            </span><span class="nt">operationId</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">home</span>
<span class="nt">components</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</code></pre></div>
<h3 id="adding-description-and-summary">Adding description and summary<a class="headerlink" href="#adding-description-and-summary" title="Permanent link">&para;</a></h3>
<p>An endpoint description can be specified either using a <code>docstring</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@docs</span><span class="p">(</span><span class="n">responses</span><span class="o">=</span><span class="p">{</span><span class="mi">200</span><span class="p">:</span> <span class="s2">&quot;Returns a text saying OpenAPI Example&quot;</span><span class="p">})</span>
<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This example is used to demonstrate support for OpenAPI in BlackSheep.</span>
<span class="sd">    The endpoint itself doesn&#39;t do anything useful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;OpenAPI Example&quot;</span>
</code></pre></div>
<p>Or in the <code>@docs</code> decorator:
<div class="highlight"><pre><span></span><code><span class="nd">@docs</span><span class="p">(</span>
    <span class="n">summary</span><span class="o">=</span><span class="s2">&quot;This example is used to demonstrate support for OpenAPI in BlackSheep.&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The endpoint itself doesn&#39;t do anything useful.&quot;</span><span class="p">,</span>
    <span class="n">responses</span><span class="o">=</span><span class="p">{</span><span class="mi">200</span><span class="p">:</span> <span class="s2">&quot;Returns a text saying OpenAPI Example&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;OpenAPI Example&quot;</span>
</code></pre></div></p>
<p>When using <code>docstring</code>, the first line of the docstring is used as the summary,
and the whole docstring as the description.</p>
<p><img alt="OpenAPI description and summary" src="/blacksheep/img/openapi-description-summary.png" /></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Most of the BlackSheep code base is typed using the <code>typing</code> module,
thus IDEs and text editors like Visual Studio Code and PyCharm can provide
user's friendly hints for code completion (see the screenshot below).
<img alt="Type hints" src="/blacksheep/img/openapi-docs-type-hints.png" /></p>
</div>
<h3 id="ignoring-endpoints">Ignoring endpoints<a class="headerlink" href="#ignoring-endpoints" title="Permanent link">&para;</a></h3>
<p>To exclude certain endpoints from the API documentation, use <code>@docs.ignore()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@docs</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/hidden-from-docs&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">hidden_endpoint</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;This endpoint won&#39;t appear in documentation&quot;</span>
</code></pre></div>
<h3 id="document-only-certain-routes">Document only certain routes<a class="headerlink" href="#document-only-certain-routes" title="Permanent link">&para;</a></h3>
<p>To document only certain routes, use an include function like in the example below.
For example, to include only those routes that start with "/api":</p>
<div class="highlight"><pre><span></span><code><span class="n">docs</span> <span class="o">=</span> <span class="n">OpenAPIHandler</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example API&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">))</span>

<span class="c1"># include only endpoints whose path starts with &quot;/api/&quot;</span>
<span class="n">docs</span><span class="o">.</span><span class="n">include</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">path</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/api/&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="documenting-response-examples">Documenting response examples<a class="headerlink" href="#documenting-response-examples" title="Permanent link">&para;</a></h3>
<p>The following example shows how to describe examples for responses:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">UUID</span>

<span class="kn">from</span> <span class="nn">blacksheep</span> <span class="kn">import</span> <span class="n">Application</span><span class="p">,</span> <span class="n">json</span>
<span class="kn">from</span> <span class="nn">blacksheep.server.openapi.common</span> <span class="kn">import</span> <span class="n">ContentInfo</span><span class="p">,</span> <span class="n">ResponseExample</span><span class="p">,</span> <span class="n">ResponseInfo</span>
<span class="kn">from</span> <span class="nn">blacksheep.server.openapi.v3</span> <span class="kn">import</span> <span class="n">OpenAPIHandler</span>
<span class="kn">from</span> <span class="nn">openapidocs.v3</span> <span class="kn">import</span> <span class="n">Info</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

<span class="n">docs</span> <span class="o">=</span> <span class="n">OpenAPIHandler</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example API&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">))</span>
<span class="n">docs</span><span class="o">.</span><span class="n">bind_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">UUID</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">creation_time</span><span class="p">:</span> <span class="n">datetime</span>


<span class="nd">@docs</span><span class="p">(</span>
    <span class="n">summary</span><span class="o">=</span><span class="s2">&quot;Gets a cat by id&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;A sample API that uses a pet store as an</span>
<span class="s2">          example to demonstrate features in the OpenAPI 3 specification&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="n">responses</span><span class="o">=</span><span class="p">{</span>
        <span class="mi">200</span><span class="p">:</span> <span class="n">ResponseInfo</span><span class="p">(</span>
            <span class="s2">&quot;A cat&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="p">[</span>
                <span class="n">ContentInfo</span><span class="p">(</span>
                    <span class="n">Cat</span><span class="p">,</span>
                    <span class="n">examples</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">ResponseExample</span><span class="p">(</span>
                            <span class="n">Cat</span><span class="p">(</span>
                                <span class="nb">id</span><span class="o">=</span><span class="n">UUID</span><span class="p">(</span><span class="s2">&quot;3fa85f64-5717-4562-b3fc-2c963f66afa6&quot;</span><span class="p">),</span>
                                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Foo&quot;</span><span class="p">,</span>
                                <span class="n">creation_time</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">],</span>
                <span class="p">)</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="mi">404</span><span class="p">:</span> <span class="s2">&quot;Cat not found&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/api/cats/</span><span class="si">{cat_id}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_cat_by_id</span><span class="p">(</span><span class="n">cat_id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">):</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># TODO: implement the logic that fetches a cat by id</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
</code></pre></div>
<p>If the code seems excessively verbose, consider that OpenAPI specification is
designed to support documenting responses with different content types (e.g.
JSON, XML, etc.) and having examples for each content type. Writing the
documentation by hand would be much more time consuming!</p>
<p>BlackSheep automatically generates component schemas by type (in this example,
<code>Cat</code>) and reuses them in all API endpoints that use them:</p>
<p><img alt="OpenAPI Response Examples" src="/blacksheep/img/openapi-response-examples.png" /></p>
<h3 id="avoid-code-pollution-using-endpointdocs">Avoid code pollution using EndpointDocs<a class="headerlink" href="#avoid-code-pollution-using-endpointdocs" title="Permanent link">&para;</a></h3>
<p>If you are familiar with other libraries that produce OpenAPI Documentation and
you consider the example above, you might notice that adding OpenAPI details to
request handlers can pollute the source code and distract the programmer from
the actual request handlers' logic.</p>
<p>BlackSheep provides a way to avoid polluting the source code and keep the code
for OpenAPI in dedicated files. Use the <code>blacksheep.server.openapi.common.EndpointDocs</code>
class to define documentation in dedicated files and keep your request handlers
code clean:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">apidocs.cats</span> <span class="kn">import</span> <span class="n">get_cat_docs</span>

<span class="nd">@docs</span><span class="p">(</span><span class="n">get_cat_docs</span><span class="p">)</span>
<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/api/cats/</span><span class="si">{cat_id}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_cat_by_id</span><span class="p">(</span><span class="n">cat_id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">):</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># TODO: implement the logic that fetches a cat by id</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
</code></pre></div>
<p>To see a complete example, refer to the source code of the <a href="https://github.com/RobertoPrevato/BlackSheepMVC">MVC project
template</a>, and see how
documentation is organized and configured (in <code>app.docs</code>, <code>app.controllers.docs</code>).</p>
<h3 id="deprecating-an-api">Deprecating an API<a class="headerlink" href="#deprecating-an-api" title="Permanent link">&para;</a></h3>
<p>To mark an endpoint as deprecated, use <code>@docs.deprecated()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@docs</span><span class="o">.</span><span class="n">deprecated</span><span class="p">()</span>
<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/some-deprecated-api&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">deprecated_endpoint</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;This endpoint is deprecated&quot;</span>
</code></pre></div>
<h3 id="altering-the-specification-upon-creation">Altering the specification upon creation<a class="headerlink" href="#altering-the-specification-upon-creation" title="Permanent link">&para;</a></h3>
<p>To alter the specification file upon creation, define a subclass of
<code>OpenAPIHandler</code> that overrides <code>on_docs_generated</code> method.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">blacksheep</span> <span class="kn">import</span> <span class="n">Application</span><span class="p">,</span> <span class="n">json</span>
<span class="kn">from</span> <span class="nn">blacksheep.server.openapi.v3</span> <span class="kn">import</span> <span class="n">OpenAPIHandler</span>
<span class="kn">from</span> <span class="nn">openapidocs.v3</span> <span class="kn">import</span> <span class="n">Info</span><span class="p">,</span> <span class="n">OpenAPI</span><span class="p">,</span> <span class="n">Server</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">MyOpenAPIHandler</span><span class="p">(</span><span class="n">OpenAPIHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_docs_generated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">OpenAPI</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">docs</span><span class="o">.</span><span class="n">servers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Server</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://foo-example.org&quot;</span><span class="p">),</span>
            <span class="n">Server</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://test.foo-example.org&quot;</span><span class="p">),</span>
        <span class="p">]</span>


<span class="n">docs</span> <span class="o">=</span> <span class="n">MyOpenAPIHandler</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example API&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">))</span>
<span class="n">docs</span><span class="o">.</span><span class="n">bind_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</code></pre></div>
<h3 id="handling-common-responses">Handling common responses<a class="headerlink" href="#handling-common-responses" title="Permanent link">&para;</a></h3>
<p>APIs often implement a common way to handle failures, to provide clients with
details for web requests that cannot be completed successfully. For example, an
API might return a response body like the following, in case of a bad request
for a certain endpoint:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;The provided country code is not supported&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;InvalidCountryCode&quot;</span><span class="p">}</span>
</code></pre></div>
<p>Such response body can be handled using a <code>dataclass</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ErrorInfo</span><span class="p">:</span>
    <span class="n">error</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">code</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div>
<p><code>blacksheep</code> offers the following way to document common responses:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">openapidocs.v3</span> <span class="kn">import</span> <span class="n">MediaType</span><span class="p">,</span> <span class="n">Response</span> <span class="k">as</span> <span class="n">ResponseDoc</span><span class="p">,</span> <span class="n">Schema</span>


<span class="n">error_info</span> <span class="o">=</span> <span class="n">docs</span><span class="o">.</span><span class="n">register_schema_for_type</span><span class="p">(</span><span class="n">ErrorInfo</span><span class="p">)</span>

<span class="n">docs</span><span class="o">.</span><span class="n">common_responses</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">400</span><span class="p">:</span> <span class="n">ResponseDoc</span><span class="p">(</span>
        <span class="s2">&quot;Bad request&quot;</span><span class="p">,</span>
        <span class="n">content</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;application/json&quot;</span><span class="p">:</span> <span class="n">MediaType</span><span class="p">(</span>
                <span class="n">schema</span><span class="o">=</span><span class="n">Schema</span><span class="p">(</span>
                    <span class="n">any_of</span><span class="o">=</span><span class="p">[</span><span class="n">error_info</span><span class="p">],</span>
                    <span class="n">example</span><span class="o">=</span><span class="n">SafeException</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="s2">&quot;Invalid argument&quot;</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="mi">1001</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">},</span>
    <span class="p">),</span>
    <span class="mi">401</span><span class="p">:</span> <span class="n">ResponseDoc</span><span class="p">(</span>
        <span class="s2">&quot;Unauthorized&quot;</span><span class="p">,</span>
        <span class="n">content</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;application/json&quot;</span><span class="p">:</span> <span class="n">MediaType</span><span class="p">(</span>
                <span class="n">schema</span><span class="o">=</span><span class="n">Schema</span><span class="p">(</span>
                    <span class="n">any_of</span><span class="o">=</span><span class="p">[</span><span class="n">error_info</span><span class="p">],</span>
                    <span class="n">example</span><span class="o">=</span><span class="n">SafeException</span><span class="p">(</span>
                        <span class="n">error</span><span class="o">=</span><span class="s2">&quot;The user is not authorized&quot;</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="mi">3</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">},</span>
    <span class="p">),</span>
<span class="p">}</span>
</code></pre></div>
<p>Common responses are configured for all endpoints.</p>
<h3 id="support-for-generics">Support for generics<a class="headerlink" href="#support-for-generics" title="Permanent link">&para;</a></h3>
<p>The generation of OpenAPI Documentation supports the handling of <a href="https://docs.python.org/3/library/typing.html#typing.Generic">generic
types</a>. Consider
the following example:</p>
<ol>
<li>a common task is to implement an API that returns a paginated subset of
   elements, usually given some filters (e.g. textual search)</li>
<li>clients need to know the count of items that match the filters, to display
   the total number of items and the number of pages that are necessary to
   display all results (depending on page size)</li>
<li>for such a scenario, using a <code>Generic</code> type is a good solution, because many
   kinds of objects can be paginated</li>
</ol>
<p><em>Example of generic class definition</em></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">TypeVar</span>


<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PaginatedSet</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="n">items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]</span>
    <span class="n">total</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div>
<p><em>Full example illustrating OpenAPI Documentation for generics</em></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">TypeVar</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">UUID</span>

<span class="kn">from</span> <span class="nn">openapidocs.v3</span> <span class="kn">import</span> <span class="n">Info</span>

<span class="kn">from</span> <span class="nn">blacksheep</span> <span class="kn">import</span> <span class="n">Application</span><span class="p">,</span> <span class="n">FromQuery</span>
<span class="kn">from</span> <span class="nn">blacksheep.server.openapi.v3</span> <span class="kn">import</span> <span class="n">OpenAPIHandler</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PaginatedSet</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="n">items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]</span>
    <span class="n">total</span><span class="p">:</span> <span class="nb">int</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Order</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">UUID</span>
    <span class="n">customer_id</span><span class="p">:</span> <span class="n">UUID</span>
    <span class="n">creation_time</span><span class="p">:</span> <span class="n">datetime</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>


<span class="c1"># enable OpenAPI Documentation</span>
<span class="n">docs</span> <span class="o">=</span> <span class="n">OpenAPIHandler</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">))</span>
<span class="n">docs</span><span class="o">.</span><span class="n">bind_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/api/orders&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_orders</span><span class="p">(</span>
    <span class="n">page</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">page_size</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">search</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PaginatedSet</span><span class="p">[</span><span class="n">Order</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a paginated set of orders.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<p>In the example below, the generic type is handled properly and produces the
following OpenAPI Documentation:</p>
<div class="highlight"><pre><span></span><code><span class="nt">openapi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.0.3</span>
<span class="nt">info</span><span class="p">:</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Example</span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.1</span>
<span class="nt">paths</span><span class="p">:</span>
<span class="w">    </span><span class="nt">/api/orders</span><span class="p">:</span>
<span class="w">        </span><span class="nt">get</span><span class="p">:</span>
<span class="w">            </span><span class="nt">responses</span><span class="p">:</span>
<span class="w">                </span><span class="s">&#39;200&#39;</span><span class="p p-Indicator">:</span>
<span class="w">                    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Success response</span>
<span class="w">                    </span><span class="nt">content</span><span class="p">:</span>
<span class="w">                        </span><span class="nt">application/json</span><span class="p">:</span>
<span class="w">                            </span><span class="nt">schema</span><span class="p">:</span>
<span class="w">                                </span><span class="nt">$ref</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;#/components/schemas/PaginatedSetOfOrder&#39;</span>
<span class="w">            </span><span class="nt">operationId</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">get_orders</span>
<span class="w">            </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Returns a paginated set of orders.</span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Returns a paginated set of orders.</span>
<span class="w">            </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w">   </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">page</span>
<span class="w">                </span><span class="nt">in</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">query</span>
<span class="w">                </span><span class="nt">schema</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">                    </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int64</span>
<span class="w">                    </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">                </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w">   </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">page_size</span>
<span class="w">                </span><span class="nt">in</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">query</span>
<span class="w">                </span><span class="nt">schema</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">                    </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int64</span>
<span class="w">                    </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">                </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w">   </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">search</span>
<span class="w">                </span><span class="nt">in</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">query</span>
<span class="w">                </span><span class="nt">schema</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">                    </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">                </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="nt">components</span><span class="p">:</span>
<span class="w">    </span><span class="nt">schemas</span><span class="p">:</span>
<span class="w">        </span><span class="nt">Order</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">            </span><span class="nt">required</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">id</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer_id</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">creation_time</span>
<span class="w">            </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">                </span><span class="nt">id</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">                    </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uuid</span>
<span class="w">                    </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">                </span><span class="nt">customer_id</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">                    </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uuid</span>
<span class="w">                    </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">                </span><span class="nt">creation_time</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">                    </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">date-time</span>
<span class="w">                    </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">        </span><span class="nt">PaginatedSetOfOrder</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">            </span><span class="nt">required</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">items</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">total</span>
<span class="w">            </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">                </span><span class="nt">items</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">array</span>
<span class="w">                    </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">                    </span><span class="nt">items</span><span class="p">:</span>
<span class="w">                        </span><span class="nt">$ref</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;#/components/schemas/Order&#39;</span>
<span class="w">                </span><span class="nt">total</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">                    </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int64</span>
<span class="w">                    </span><span class="nt">nullable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Generic types, expressed in Python using <code>GenericType[T]</code>, are
represented with <code>GenericTypeOfT</code> to respect OpenAPI specification, saying
that <code>$ref values must be RFC3986-compliant percent-encoded URIs</code>.
A generic type with more arguments, like <code>Foo[T, U, X]</code> gets represented with
<code>FooOfTAndUAndX</code>.</p>
</div>
<h3 id="describing-parameters">Describing parameters<a class="headerlink" href="#describing-parameters" title="Permanent link">&para;</a></h3>
<p>It is possible to describe parameters explicitly, using docstrings, or
leveraging <code>Pydantic</code>.</p>
<h4 id="documenting-parameters-explicitly">Documenting parameters explicitly<a class="headerlink" href="#documenting-parameters-explicitly" title="Permanent link">&para;</a></h4>
<p>To document parameters explicitly, use the <code>@docs</code> like in the following
example (elaborating on the previous example about generics):</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">blacksheep.server.openapi.common</span> <span class="kn">import</span> <span class="n">ParameterInfo</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>


<span class="c1"># enable OpenAPI Documentation</span>
<span class="n">docs</span> <span class="o">=</span> <span class="n">OpenAPIHandler</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">))</span>
<span class="n">docs</span><span class="o">.</span><span class="n">bind_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/api/orders&quot;</span><span class="p">)</span>
<span class="nd">@docs</span><span class="p">(</span>
    <span class="n">parameters</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="n">ParameterInfo</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Page number&quot;</span><span class="p">),</span>
        <span class="s2">&quot;page_size&quot;</span><span class="p">:</span> <span class="n">ParameterInfo</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The number of items to display per page&quot;</span>
        <span class="p">),</span>
        <span class="s2">&quot;search&quot;</span><span class="p">:</span> <span class="n">ParameterInfo</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Optional text search&quot;</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_orders</span><span class="p">(</span>
    <span class="n">page</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">page_size</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">search</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PaginatedSet</span><span class="p">[</span><span class="n">Order</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a paginated set of orders.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<h4 id="documenting-parameters-using-docstrings">Documenting parameters using docstrings<a class="headerlink" href="#documenting-parameters-using-docstrings" title="Permanent link">&para;</a></h4>
<p>BlackSheep supports documenting parameters using docstrings, and the following
styles are supported: Epytext, ReStructuredText, NumpyDoc.
The following sections show the previous example re-written to use docstrings.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Epytext</label><label for="__tabbed_1_2">ReStructuredText</label><label for="__tabbed_1_3">NumpyDoc</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nd">@router</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/api/orders&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_orders</span><span class="p">(</span>
    <span class="n">page</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">page_size</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">search</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PaginatedSet</span><span class="p">[</span><span class="n">Order</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a paginated set of orders.</span>

<span class="sd">    @param page: Page number</span>
<span class="sd">    @param page_size: The number of items to display per page</span>
<span class="sd">    @param search: Optional text search</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nd">@router</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/api/orders&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_orders</span><span class="p">(</span>
    <span class="n">page</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">page_size</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">search</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PaginatedSet</span><span class="p">[</span><span class="n">Order</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a paginated set of orders.</span>

<span class="sd">    :param page: Page number</span>
<span class="sd">    :param page_size: The number of items to display per page</span>
<span class="sd">    :param search: Optional text search</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nd">@router</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/api/orders&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_orders</span><span class="p">(</span>
    <span class="n">page</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">page_size</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">search</span><span class="p">:</span> <span class="n">FromQuery</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FromQuery</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PaginatedSet</span><span class="p">[</span><span class="n">Order</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a paginated set of orders.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    page : Page number</span>
<span class="sd">    page_size : The number of items to display per page</span>
<span class="sd">    search : Optional text search</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<p>The logic that parses docstrings can also extract types information, but this
is not documented because the recommended way is to use type annotations.
Refer to the file <code>test_openapi_docstrings.py</code> for more examples on the
information that can be extracted from docstrings.</p>
<h3 id="anonymous-access">Anonymous access<a class="headerlink" href="#anonymous-access" title="Permanent link">&para;</a></h3>
<p>If the server uses a default authorization policy that requires an
authenticated user, it is still possible to make the OpenAPI Documentation
endpoint available for anonymous access, using the <code>anonymous_access</code>
parameter:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">blacksheep.server.openapi.v3</span> <span class="kn">import</span> <span class="n">OpenAPIHandler</span>
<span class="kn">from</span> <span class="nn">openapidocs.v3</span> <span class="kn">import</span> <span class="n">Info</span>

<span class="n">docs</span> <span class="o">=</span> <span class="n">OpenAPIHandler</span><span class="p">(</span>
    <span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example API&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">),</span> <span class="n">anonymous_access</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># include only endpoints whose path starts with &quot;/api/&quot;</span>
<span class="n">docs</span><span class="o">.</span><span class="n">include</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">path</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/api/&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="support-for-redoc-ui">Support for ReDoc UI<a class="headerlink" href="#support-for-redoc-ui" title="Permanent link">&para;</a></h3>
<p>BlackSheep supports <a href="https://github.com/Redocly/redoc">ReDoc UI</a>, although
this is disabled by default. It is also possible to implement custom UIs for
the documentation endpoints, using the <code>ui_providers</code> property of the
<code>OpenAPIHandler</code> class, and implementing a custom <code>UIProvider</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">blacksheep.server.openapi.v3</span> <span class="kn">import</span> <span class="n">OpenAPIHandler</span>
<span class="kn">from</span> <span class="nn">blacksheep.server.openapi.ui</span> <span class="kn">import</span> <span class="n">ReDocUIProvider</span>
<span class="kn">from</span> <span class="nn">openapidocs.v3</span> <span class="kn">import</span> <span class="n">Info</span>

<span class="n">docs</span> <span class="o">=</span> <span class="n">OpenAPIHandler</span><span class="p">(</span>
    <span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example API&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">docs</span><span class="o">.</span><span class="n">ui_providers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ReDocUIProvider</span><span class="p">())</span>

<span class="c1"># include only endpoints whose path starts with &quot;/api/&quot;</span>
<span class="n">docs</span><span class="o">.</span><span class="n">include</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">path</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/api/&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="how-to-implement-a-custom-uiprovider">How to implement a custom UIProvider<a class="headerlink" href="#how-to-implement-a-custom-uiprovider" title="Permanent link">&para;</a></h3>
<p>The BlackSheep package includes some static files to offer a good user
experience in some circumstances. These include HTML pages used when enabling
Swagger UI or ReDoc UI.</p>
<p>To control those pages, for example, to alter the HTML structure or use
different sources for JavaScript and CSS files (which by the way could be the
BlackSheep application serving the OpenAPI specification files), it is
recommended to:</p>
<ul>
<li>define a custom implementation of <code>UIProvider</code></li>
<li>maintain the desired HTML file</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">blacksheep</span> <span class="kn">import</span> <span class="n">Application</span>
<span class="kn">from</span> <span class="nn">blacksheep.server.openapi.v3</span> <span class="kn">import</span> <span class="n">OpenAPIHandler</span>
<span class="kn">from</span> <span class="nn">blacksheep.server.openapi.ui</span> <span class="kn">import</span> <span class="n">SwaggerUIProvider</span><span class="p">,</span> <span class="n">UIOptions</span>
<span class="kn">from</span> <span class="nn">openapidocs.v3</span> <span class="kn">import</span> <span class="n">Info</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">CustomUIProvider</span><span class="p">(</span><span class="n">SwaggerUIProvider</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_openapi_ui_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">UIOptions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">_template</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;example.html&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">_template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{options.spec_url}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">spec_url</span><span class="p">)</span>


<span class="n">docs</span> <span class="o">=</span> <span class="n">OpenAPIHandler</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Example API&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;0.0.1&quot;</span><span class="p">))</span>
<span class="c1"># Set the UI provider as desired:</span>
<span class="n">docs</span><span class="o">.</span><span class="n">ui_providers</span> <span class="o">=</span> <span class="p">[</span><span class="n">CustomUIProvider</span><span class="p">()]</span>
<span class="n">docs</span><span class="o">.</span><span class="n">bind_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="n">foo</span><span class="p">:</span> <span class="nb">str</span>


<span class="nd">@route</span><span class="p">(</span><span class="s2">&quot;/foo&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Foo</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Foo</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span>
</code></pre></div>
<p><em>example.html</em>:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>My desired title<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;icon&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/favicon.png&quot;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/5.10.0/swagger-ui.css&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;swagger-ui&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/5.10.0/swagger-ui-bundle.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">ui</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">SwaggerUIBundle</span><span class="p">({</span>
<span class="w">        </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;{options.spec_url}&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">oauth2RedirectUrl</span><span class="o">:</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/docs/oauth2-redirect&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">dom_id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;#swagger-ui&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">presets</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="nx">SwaggerUIBundle</span><span class="p">.</span><span class="nx">presets</span><span class="p">.</span><span class="nx">apis</span><span class="p">,</span>
<span class="w">            </span><span class="nx">SwaggerUIBundle</span><span class="p">.</span><span class="nx">SwaggerUIStandalonePreset</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nx">layout</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;BaseLayout&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">deepLinking</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">showExtensions</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">showCommonExtensions</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>Python code highlight:</p>
<div class="highlight"><pre><span></span><code><span class="gi">+from blacksheep.server.openapi.ui import SwaggerUIProvider, UIOptions</span>
from openapidocs.v3 import Info

app = Application()


<span class="gi">+class CustomUIProvider(SwaggerUIProvider):</span>
<span class="gi">+    def get_openapi_ui_html(self, options: UIOptions) -&gt; str:</span>
<span class="gi">+        _template = Path(&quot;example.html&quot;).read_text()</span>
<span class="gi">+        return _template.replace(&quot;{options.spec_url}&quot;, options.spec_url)</span>


docs = OpenAPIHandler(info=Info(title=&quot;Example API&quot;, version=&quot;0.0.1&quot;))
# Set the UI provider as desired:
<span class="gi">+docs.ui_providers = [CustomUIProvider()]</span>
docs.bind_app(app)
</code></pre></div>
<h3 id="changing-operations-ids">Changing operations ids<a class="headerlink" href="#changing-operations-ids" title="Permanent link">&para;</a></h3>
<p>When OpenAPI Documentation is generated, operation ids are obtained from the
name of the Python function definitions.</p>
<p>For example, having a <code>get_foo</code> request handler generates an object having
<code>operationId</code> equal to "get_foo":</p>
<div class="highlight"><pre><span></span><code><span class="nd">@router</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/foo&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Foo</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Foo</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">&quot;paths&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;/foo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;get&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="err">…</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;operationId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;get_foo&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
</code></pre></div>
<p>To change how <code>operationId</code> is generated for endpoints, define a custom type
of <code>OpenAPIHandler</code> that overrides the <code>get_operation_id</code> method, to produce
the desired result:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CustomOpenAPIHandler</span><span class="p">(</span><span class="n">OpenAPIHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_operation_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EndpointDocs</span><span class="p">],</span> <span class="n">handler</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">handler</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="for-more-details">For more details<a class="headerlink" href="#for-more-details" title="Permanent link">&para;</a></h3>
<p>For more details on the OpenAPI specification and to understand some details
such as security settings, refer to the official <a href="https://swagger.io/specification/">swagger.io
website</a>, and the dedicated library to
generate the specification file:
<a href="https://github.com/Neoteroi/essentials-openapi">essentials-openapi</a>.</p>
<div class="nt-contribs"><p class="nt-mod-time">Last modified on: 2023-12-18 17:52:09</p><div class="nt-contributors"><div class="nt-contributor image nt-group-0" title="Roberto Prevato &lt;roberto.prevato@gmail.com&gt; (5)" style="background-image: url('https://avatars.githubusercontent.com/u/2576032?s=400&amp;u=d8d880e8ed05bb170877dd3d561d8301c4beeeed&amp;v=4')"><span class="nt-initials" /></div><div class="nt-contributor nt-group-1" title="Elliot Waite &lt;elliot@elliotwaite.com&gt; (1)"><span class="nt-initials">EW</span></div><div class="nt-contributor nt-group-2" title="Roman Vlasenko &lt;56698047+Klavionik@users.noreply.github.com&gt; (1)"><span class="nt-initials">RV</span></div><div class="nt-contributor nt-group-3" title="techntools &lt;71767293+techntools@users.noreply.github.com&gt; (1)"><span class="nt-initials">T</span></div></div></div>





<!-- Giscus snippet -->
<script src="https://giscus.app/client.js"
    data-repo="Neoteroi/BlackSheep-Docs"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzNzYyOTM4ODI="
    data-category="Q&A"
    data-category-id="DIC_kwDOFm3J-s4CSpF8"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="dark_tritanopia"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
</script>

<!-- Synchronize Giscus theme with palette -->
<script>
  var giscus = document.querySelector("script[src*=giscus]")

  /* Set palette on initial load */
  var palette = __md_get("__palette")
  if (palette && typeof palette.color === "object") {
    var theme = palette.color.scheme === "slate" ? "dark" : "light"
    giscus.setAttribute("data-theme", theme)
  }

  /* Register event handlers after documented loaded */
  document.addEventListener("DOMContentLoaded", function() {
    var ref = document.querySelector("[data-md-component=palette]")
    ref.addEventListener("change", function() {
      var palette = __md_get("__palette")
      if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate" ? "dark" : "light"

        /* Instruct Giscus to change theme */
        var frame = document.querySelector(".giscus-frame")
        frame.contentWindow.postMessage(
          { giscus: { setConfig: { theme } } },
          "https://giscus.app"
        )
      }
    })
  })
</script>

                

              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="/blacksheep/dependency-injection/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Dependency injection" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Dependency injection
              </div>
            </div>
          </a>
        
        
          
          <a href="/blacksheep/application/" class="md-footer__link md-footer__link--next" aria-label="Next: Application" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Application
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.footer", "content.code.copy", "content.action.view"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": 2}</script>
    
    
      <script src="/blacksheep/assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>